= Dokumentation Netzwerktechnik
Klose Peter, Angerer Mona
1.0.0, 2022-03-21:
ifndef::imagesdir[:imagesdir: images]
//:toc-placement!:  // prevents the generation of the doc at this position, so it can be printed afterwards
:sourcedir: ../src/main/java
:icons: font
:sectnums:    // Nummerierung der Überschriften / section numbering
:toc: left

//Need this blank line after ifdef, don't know why...
ifdef::backend-html5[]

// print the toc here (not at the default position)
//toc::[]

== Überblick:

=== Ausgangslage:

==== IP Adresse:
|===
|Name |Adresse

|Netzwerk:
|*10.9.8.0*

|Start:
|*10.9.8.1*

|Ende:
|*10.9.8.6*

|Broadcast:
|*10.9.8.7*

|Subnetzmaske:
|*255.255.255.248* oder */29*
|===

==== Proxmox

Zur Verfügung hatten wir einen Container, welchen wir zuvor gemeinsam konfiguriert hatten.
Die ganze Configuration war noch nicht eingerichtet, somit hatten wir auch kein Internet.

=== Zielsetzung:

Realisierung des unten in der Grafik gezeigten Systems.

Über den Router soll die Kommunikation vom internen Netzwerk 10.9.8.0/29 nach außen in das GlueNetzwerk 10.9.8.0/24 möglich sein.

_Alle CT (Container) und VMs (virtuelle Maschinen):_

* sollen über ssh erreichbar sein, da das Terminal in Proxmox selbst öfters laggt.
* müssen somit Ping bar sein innerhalb und außerhalb.

==== Grafik:
image::aufbau.png[]

== Generelle Konfiguration

NOTE:: Folgendes wird nur auf *CT* ausgeführt **nicht Lubuntu**

//Alle Netzwerkkarten befinden sich auf der `vmbr8 bridge`, weil diese mit der Adresse *10.9.8.** unsere Klasse realisiert.
=== sudo

Sudo wird installiert und um den gewohnten workflow mit `sudo <cmd>` oder als admin registrieren `sudo -s`zu gewährleisten.

.Installation
[source,bash]
----
apt update && apt upgrade -y
apt install sudo
----

NOTE:: Sudo ist nicht notwendig

=== SSH

SSH wird verwendet, damit wir effizienter und schneller arbeiten können. Auf Proxmox selbst gibt es nämlich manchmal eingabe bugs die mit ssh nicht mehr vorkommen.

IMPORTANT:: Damit SSH funktioniert *muss* der *Container* und der *Router* richtig konfiguriert sein.

.Installation
[source,bash]
----
apt-get update
apt update && apt upgrade -y

apt install openssh-server

systemctl enable ssh
systemctl start ssh

#check if running
systemctl status ssh

----


== CT und VM Konfiguration



Virtuelle Maschinen:

=== Webserver (nginx)

Container:

=== Router

* IP-Adressen:
|===
|Anordnung |Adresse |Gateway

|Innen:
|10.9.8.6/29
|-

|Außen:
|10.9.8.255/26
|10.9.8.254

|===



=== Lubuntu

=== Pi-hole

* Link zum Adminpanel: http://10.9.8.3/admin[hier]
** nur möglich innerhalb des Schulnetzwerks.
* Für weitere Konfiguration: https://sakis.tech/pi-hole-auf-einem-lxc-installieren-und-konfigurieren/[hier]

==== Konfiguration

*sudo* und *SSH* siehe oben.

.SSH Zugang für Root freischalten
[source,bash]
----
nano /etc/ssh/sshd_config <.>
service ssh restart <.>
----

<.> ändern sie `#PermitRootLogin prohibit-password` auf `PermitRootLogin yes`
<.> ssh wird neu gestartet damit die änderungen wirksam werden.

==== Intsallation

.Installations Pi-hole
[source,bash]
----
apt update && apt upgrade -y <.>
apt-get install curl -y <.>
curl -sSL https://install.pi-hole.net | bash <.>
----

<.> System auf neusten Stand bringen
<.> `Curl` wird bei der Installation benötigt
<.> Installation von Pi-hole

Nun müssen sie ein bisschen warten, dann werden sie von einem Installationsmenü begrüßt. Hier können alle Einstellungen auf Standard gelassen werden.

.Admin Passwort ändern
[source,bash]
----
pihole -a -p <.>
----

<.> neues Kennwort 2-mal eingeben. Fertig.

IMPORTANT:: Dieses Passwort wird am Webinterface benötigt.






//=== Einschränkungen:

//==== IP Adressen:



